# -----------------------------------------------------
# INIT by Luiza
# -----------------------------------------------------
# This file is sourced by all *interactive* bash shells on startup,
# including some apparently interactive shells such as scp and rcp
# that can't tolerate any output.  So make sure this doesn't display
# anything or bad things will happen !

export BASHRC_CUSTOM_LOADED=1
#source /etc/profile #already loaded
if test "x$XDG_CONFIG_HOME" = "x" ; then
  export XDG_CONFIG_HOME=$HOME/.config
fi
if test "x$XDG_DATA_HOME" = "x" ; then
  export XDG_DATA_HOME=$HOME/.local/share
fi

# moved to 25-custom-aliases
# source $XDG_CONFIG_HOME/bash/bash_aliases

if [ -d "functions.d" ]; then
        for rc in functions.d/*; do
                if [ -f "$rc" ]; then
                        . "$rc"
                fi
        done
fi

export WINEPREFIX="/home/talto/.local/share/wineprefixes/clean_64"
export WINE_LARGE_ADDRESS_AWARE=1
export WINEFSYNC=1 #Often improves performance for CPU-bound applications, should be left disabled if get crashes mentioning fsync errors.

export USER_AGENT=kenose

if [[ -n "$SSH_CONNECTION" ]]; then
    export PINENTRY_USER_DATA="USE_CURSES=1"
fi
# source https://wiki.gentoo.org/wiki/GnuPG
# very annoying, disabling GPG
export GPG_TTY=$(tty)
test -n "$GPG_TTY" || export GPG_TTY=/dev/tty
#unset SSH_AGENT_PID
#if [ "${gnupg_SSH_AUTH_SOCK_by:-0}" -ne $$ ]; then
#    export SSH_AUTH_SOCK="$(gpgconf --list-dirs agent-ssh-socket)"
#fi
# leave this here instead of the aliases file, too important
#alias ssh="gpg-connect-agent updatestartuptty /bye >/dev/null && ssh"
# I fucked it up, have to do this kind of shit now *eyeroll*
#case "$SSH_AUTH_SOCK" in
#  */gnupg/S.gpg-agent.ssh) unset SSH_AUTH_SOCK SSH_AGENT_PID ;;
#esac

export IFS_LB=$'\n'
#export HISTFILE="$XDG_DATA_HOME/bash/bash_history"
export HISTFILE="$XDG_DATA_HOME/bashrc/history" #something is overriding bash_history with history, forcing history then
export HISTCONTROL="$HISTCONTROL erasedups:ignoreboth"

#PS1 created using https://bash-prompt-generator.org/, output: [20:14:47] hostname ~/bin $
# using oh-my-posh now, probably meaningless
# time_color="38;5;2m"
time_color="38;5;202;1m"
address_color="38;5;208;1m"
path_color="38;5;130;1m"
separator_color="38;5;202;1m"
# export PS1="\[$(tput bold)\]\[\033[38;5;5m\][\t]\[$(tput sgr0)\] \[$(tput sgr0)\]\[$(tput bold)\]\[\033[38;5;9m\]\u@\h\[$(tput sgr0)\] \[$(tput sgr0)\]\[$(tput bold)\]\[\033[38;5;12m\]\w\[$(tput sgr0)\] \[$(tput sgr0)\]\[$(tput bold)\]\[\033[38;5;12m\]\\$\[$(tput sgr0)\] \[$(tput sgr0)\]"
#\w shows $HOME as ~, $(pwd) as /home/<user>
unset "$PS1"
PROMPT="\[$(tput bold)\]\[\033[$time_color\][\t]\[$(tput sgr0)\] \[$(tput sgr0)\]\[$(tput bold)\]\[\033[$address_color\]\h\[$(tput sgr0)\] \[$(tput sgr0)\]\[$(tput bold)\]\[\033[$path_color\]\$(pwd)\[$(tput sgr0)\] \[$(tput sgr0)\]\[$(tput bold)\]\[\033[$separator_color\]\\$\[$(tput sgr0)\] \[$(tput sgr0)\]"
export PS1=$PROMPT

#eval `dircolors` # leave this to /etc/bash/bashrc

# export JDK_HOME="/opt/openjdk-jdk-current"
# export JDK_HOME="$HOME/.gentoo/java-config-2/current-user-vm"
# export JAVA_HOME=$JDK_HOME
# export ANDROID_HOME="/home/talto/install/android-sdk-linux"
# export CLASSPATH=".:$JDK_HOME/lib/commons-cli-1.1.jar/:$JDK_HOME/lib/commons-net-1.4.1.jar:"

export PATH="$PATH:$HOME/bin:/usr/games/bin:$HOME/.local/bin"
# Gentoo stuff:
# export PATH="$PATH:$HOME/install/android-sdk-linux/platform-tools/:$HOME/install/android-sdk-linux/tools:$HOME/install/Linux_Unreal_Engine_5.2.1/Engine/Binaries/Linux/"
# export PATH="$PATH:$HOME/.local/share/solana/install/active_release/bin:$HOME/install/certbot-namecheap-hook:$HOME/install/VSCode-linux-x64/bin/"
# export PATH="$PATH:/home/talto/GoogleDrive/workspace/minilogue/logue-sdk/emsdk:/home/talto/GoogleDrive/workspace/minilogue/logue-sdk/emsdk/fastcomp/emscripten:/home/talto/GoogleDrive/workspace/minilogue/logue-sdk/emsdk/node/12.9.1_64bit/bin" #minilogue stuff

if test -z "${XDG_RUNTIME_DIR}"; then
    export XDG_RUNTIME_DIR=/tmp/${UID}-runtime-dir
    if ! test -d "${XDG_RUNTIME_DIR}"; then
        mkdir "${XDG_RUNTIME_DIR}"
        chmod 0700 "${XDG_RUNTIME_DIR}"
    fi
fi

# Added by Google Cloud SDK
# The next line updates PATH for the Google Cloud SDK.
if [ -f '/home/talto/install/google-cloud-sdk/path.bash.inc' ]; then . '/home/talto/install/google-cloud-sdk/path.bash.inc'; fi
# The next line enables shell command completion for gcloud.
if [ -f '/home/talto/install/google-cloud-sdk/completion.bash.inc' ]; then . '/home/talto/install/google-cloud-sdk/completion.bash.inc'; fi

# >>> mamba initialize >>>
# !! Contents within this block are managed by 'mamba init' !!
# export MAMBA_EXE='/home/talto/.micromamba/bin/micromamba';
# export MAMBA_ROOT_PREFIX='/home/talto/micromamba';
# __mamba_setup="$("$MAMBA_EXE" shell hook --shell bash --root-prefix "$MAMBA_ROOT_PREFIX" 2> /dev/null)"
# if [ $? -eq 0 ]; then
#     eval "$__mamba_setup"
# else
#     alias micromamba="$MAMBA_EXE"  # Fallback on help from mamba activate
# fi
# unset __mamba_setup
# <<< mamba initialize <<<

# >>> conda initialize >>>
# !! Contents within this block are managed by 'conda init' !!
# __conda_setup="$('/home/talto/micromamba/bin/conda' 'shell.bash' 'hook' 2> /dev/null)"
# if [ $? -eq 0 ]; then
#     eval "$__conda_setup"
# else
#     if [ -f "/home/talto/micromamba/etc/profile.d/conda.sh" ]; then
#         . "/home/talto/micromamba/etc/profile.d/conda.sh"
#     else
#         export PATH="/home/talto/micromamba/bin:$PATH"
#     fi
# fi
# unset __conda_setup
# <<< conda initialize <<<

# needed for NVIDIA/games
# moved to ~/.config/uwsm/env
# export __GL_SYNC_TO_VBLANK=1
# export __GL_THREADED_OPTIMIZATIONS=1
# export __GL_YIELD=USLEEP

export SOLANA_METRICS_CONFIG="host=https://metrics.solana.com:8086,db=tds,u=testnet_write,p=c4fa841aa918bf8274e3e2a44d77568d9861b3ea"

export WORKON_HOME=$HOME/.virtualenvs
export PROJECT_HOME=$HOME/workspace/python
source /usr/bin/virtualenvwrapper.sh

source '/home/talto/.bash_completions/open-webui.sh'
# export OPENAI_API_KEY="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"

export NVM_DIR="$HOME/.config/nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion

#eval $(keychain --quiet --agents ssh id_ed25519) ; . ~/.keychain/$HOSTNAME-sh
